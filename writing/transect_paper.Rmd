---
title: "A Tale of Two Transects"
subtitle: "Also Two Sequencing Technologies, and Two Amplicons"
author: 
  - Brendan Furneaux^1^,
    RoÃ«l Houdanon^2^,
    Mohammad Bahram^1^,
    Anna Rosling^3^,
    Nourou S. Yorou^2^,
    Martin Ryberg^1^
  - ^1^Program in Systematic Biology,
    Department of Organismal Biology,
    Uppsala University,
    Uppsala, Sweden
  - ^2^Research Unit in Tropical Mycology and Plant-Fungi Interactions,
    LEB,
    University of Parakou,
    Parakou, Benin
  - ^3^Program in Evolutionary Biology,
    Department of Ecology and Genetics,
    Uppsala University,
    Uppsala, Sweden
date: "`r format(Sys.time(), '%B %d, %Y')`"
bibliography:
  - "all.bib"
  - "R.bib"
csl: fungal-ecology.csl
panflute-filters: figurefilter
panflute-path: '../../python'
output:
  bookdown::pdf_document2:
    fig_crop: no
    keep_tex: yes
    latex_engine: lualatex
    includes:
      in_header: preamble.tex
  bookdown::word_document2: 
    keep_md: yes
---

```{r setup, include=FALSE}
library("knitr")
library("tikzDevice")
knitr::opts_chunk$set(dev="tikz",
                      # dev.args = list(pointsize=32),
                      echo=FALSE,
                      results='asis',
                      fig.show='asis',
                      external=TRUE)
options(tikzDefaultEngine = "luatex",
        tikzLualatexPackages = c(options("tikzXelatexPackages")$tikzXelatexPackages,
                                "\\usepackage[version=4]{mhchem}\n",
                                "\\usepackage{siunitx}\n",
                                "\\DeclareSIUnit\\year{a}\n"))

base.dir <- regmatches(getwd(), regexpr(".*oueme-fungi-transect", getwd()))
if (opts_chunk$get("dev") == "tikz") {
  # styles$Expression <- styles$LaTeX.Expression
  # styles$Name <- styles$LaTeX.Name
  # styles$Short.Name <- styles$LaTeX.Short.Name
  # styles$Unit <- paste0("\\si{", styles$LaTeX.Unit, "}")
}
write_bib(c("base", "vegan", "permute"), file = "R.bib", tweak = TRUE)
```
# Introduction

# Methods

## Sampling

## Soil Chemistry

## DNA extraction, PCR, and sequencing

  - lysis in field Zymo Research Xpedition kit
  - short amplicon : gITS7 -- ITS4 (multiplexing index on gITS7)
  - long amplicon : ITS1 -- LR5 (multiplexing index on both ends)
  - short amplicon : same library sequenced with PacBio RS II and Ion Proton S5
  - long amplicon : PacBio RS II
  
## Bioinformatics

  - Two workflows for short reads:
    - Mohammad's workflow in Pipecraft
    - Brendan's workflow using Snakemake/Drake
  
  - Brendan's pipeline:
      - Ion Torrent
          - used demultiplexing from SciLife (standard IonXpress)
          - primers removed with `cutadapt` [@martin2011]
      - PacBio
          - CCS basecalls re-done with `ccs` version ___ [@pacificbiosciences2019]
          - demultiplexed and primers removed with `cutadapt` [@martin2011]
      - ITS1, ITS2, ITS, LSU extracted using ITSx [@Nilsson2010, @bengtsson-palme2013]
      - extracted regions independently quality filtered by max expected error using `dada2::filterAndTrim()`
      - dereplicated using `dada2::derepFastq()`
      - denoised with `dada2::dada()`
      - de novo chimera removal using `dada2::removeBimeraDenovo()`
      - taxonomy assigned using `dada2::assignTaxonomy()` with Unite database (ITS, ITS1, ITS2, long, short)[@nilsson2019a], RDP (LSU, long)[@cole2014], and Silva (LSU, long) databases
## Statistics

# Results

# Discussion

# Bibliography {-}

<div id="refs"></div>